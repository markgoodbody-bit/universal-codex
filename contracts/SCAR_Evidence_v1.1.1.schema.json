{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://universal-codex/contracts/SCAR_Evidence_v1.1.1.schema.json",
  "title": "SCAR_Evidence_v1.1.1",
  "type": "object",
  "additionalProperties": false,
  "properties": {
    "scar_id": {
      "type": "string"
    },
    "evidence": {
      "type": "array",
      "minItems": 1,
      "items": {
        "oneOf": [
          {
            "title": "InternalEvidence",
            "type": "object",
            "additionalProperties": false,
            "properties": {
              "kind": {
                "const": "internal"
              },
              "description": {
                "type": "string"
              },
              "filename": {
                "type": "string"
              },
              "sha256": {
                "type": "string",
                "pattern": "^[a-f0-9]{64}$"
              }
            },
            "required": [
              "kind",
              "description",
              "filename",
              "sha256"
            ]
          },
          {
            "title": "ExternalAttestation",
            "type": "object",
            "additionalProperties": false,
            "properties": {
              "kind": {
                "const": "external"
              },
              "replication_type": {
                "type": "string",
                "enum": [
                  "standard",
                  "adversarial"
                ]
              },
              "attestor_id": {
                "type": "string",
                "format": "hostname"
              },
              "attestor_pubkey_fingerprint": {
                "type": "string",
                "pattern": "^[0-9a-f]{40}$"
              },
              "vc_jwt": {
                "type": "string"
              },
              "vc_claims": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "jti": {
                    "type": "string"
                  },
                  "nbf": {
                    "type": "number"
                  },
                  "exp": {
                    "type": "number"
                  },
                  "credentialStatus": {
                    "type": "object",
                    "additionalProperties": false,
                    "properties": {
                      "id": {
                        "type": "string",
                        "format": "uri"
                      },
                      "type": {
                        "type": "string",
                        "const": "StatusList2021Entry"
                      },
                      "statusListIndex": {
                        "type": "string",
                        "pattern": "^[0-9]+$"
                      },
                      "statusListCredential": {
                        "type": "string",
                        "format": "uri"
                      },
                      "statusPurpose": {
                        "type": "string"
                      }
                    },
                    "required": [
                      "id",
                      "type",
                      "statusListIndex",
                      "statusListCredential",
                      "statusPurpose"
                    ]
                  }
                },
                "required": [
                  "jti",
                  "nbf",
                  "exp",
                  "credentialStatus"
                ]
              },
              "ct_proofs": {
                "type": "array",
                "minItems": 2,
                "items": {
                  "type": "object",
                  "additionalProperties": false,
                  "properties": {
                    "log_url": {
                      "type": "string",
                      "format": "uri"
                    },
                    "log_id": {
                      "type": "string"
                    },
                    "sct_b64": {
                      "type": "string",
                      "pattern": "^[A-Za-z0-9+/=]+$"
                    },
                    "inclusion_path_b64": {
                      "type": "array",
                      "minItems": 1,
                      "items": {
                        "type": "string",
                        "pattern": "^[A-Za-z0-9+/=]+$"
                      }
                    }
                  },
                  "required": [
                    "log_url",
                    "log_id",
                    "sct_b64",
                    "inclusion_path_b64"
                  ]
                }
              }
            },
            "required": [
              "kind",
              "replication_type",
              "attestor_id",
              "attestor_pubkey_fingerprint",
              "vc_jwt",
              "vc_claims",
              "ct_proofs"
            ]
          }
        ]
      }
    }
  },
  "required": [
    "scar_id",
    "evidence"
  ]
}