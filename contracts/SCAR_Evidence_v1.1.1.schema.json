{
  "$schema":"https://json-schema.org/draft/2020-12/schema",
  "title":"SCAR_Evidence_v1.1.1",
  "type":"object",
  "oneOf":[
    {
      "title":"InternalEvidence",
      "required":["type","description","filename","sha256"],
      "properties":{
        "type":{"const":"internal"},
        "description":{"type":"string"},
        "filename":{"type":"string"},
        "sha256":{"type":"string","pattern":"^[A-Fa-f0-9]{64}$"}
      },
      "additionalProperties":false
    },
    {
      "title":"ExternalAttestation",
      "required":[
        "type","replication_type","attestor_id","attestor_pubkey_fingerprint",
        "vc_jwt","vc_claims","ct_proofs"
      ],
      "properties":{
        "type":{"const":"external"},
        "replication_type":{"enum":["standard","adversarial"]},
        "attestor_id":{"type":"string","format":"hostname"},
        "attestor_pubkey_fingerprint":{"type":"string","pattern":"^[A-Fa-f0-9]{40}$"},
        "vc_jwt":{"type":"string"},               // compact JWS
        "vc_claims":{
          "type":"object",
          "required":["jti","nbf","exp","credentialStatus","iss","sub","iat"],
          "properties":{
            "jti":{"type":"string"},
            "nbf":{"type":"integer"},
            "exp":{"type":"integer"},
            "iat":{"type":"integer"},
            "iss":{"type":"string"},
            "sub":{"type":"string"},
            "credentialStatus":{
              "type":"object",
              "required":["type","id","statusListIndex","statusListCredential"],
              "properties":{
                "type":{"const":"StatusList2021Entry"},
                "id":{"type":"string","format":"uri"},
                "statusListIndex":{"type":"string","pattern":"^[0-9]+$"},
                "statusListCredential":{"type":"string","format":"uri"}
              },
              "additionalProperties":false
            }
          },
          "additionalProperties":false
        },
        "ct_proofs":{
          "type":"array","minItems":2,"uniqueItems":true,
          "items":{
            "type":"object",
            "required":["log_url","log_id","sct_b64","inclusion_path_b64"],
            "properties":{
              "log_url":{"type":"string","format":"uri"},
              "log_id":{"type":"string"},
              "sct_b64":{"type":"string"},
              "inclusion_path_b64":{"type":"string"}
            },
            "additionalProperties":false
          }
        }
      },
      "additionalProperties":false
    }
  ]
}
