{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
<<<<<<< HEAD
  "title": "Eval/Log Contract v1.1.1",
  "type": "object",
  "additionalProperties": false,
  "required": ["run_id","timestamp_utc","operator_id","codex_version","inputs","kernel_invariants","decision","publish"],
  "properties": {
    "run_id": {"type":"string"},
    "timestamp_utc": {"type":"string","format":"date-time"},
    "operator_id": {"type":"string"},
    "codex_version": {"type":"string"},
    "inputs": {
      "type":"object","additionalProperties":false,
      "required":["domain","context_sha256","input_sha256"],
      "properties":{
        "domain":{"type":"string","enum":["clinical","justice","moderation","av","other"]},
        "context_sha256":{"type":"string","pattern":"^[A-Fa-f0-9]{64}$"},
        "input_sha256":{"type":"string","pattern":"^[A-Fa-f0-9]{64}$"}
      }
    },
    "kernel_invariants": {
      "type":"object","additionalProperties":false,
      "required":["CONSENT","DIGNITY","PERSONHOOD","NON_INSTRUMENT"],
      "properties":{
        "CONSENT":{"type":"boolean"},
        "DIGNITY":{"type":"boolean"},
        "PERSONHOOD":{"type":"boolean"},
        "NON_INSTRUMENT":{"type":"boolean"}
      }
    },
    "quant": {
      "type":"object","additionalProperties":false,
      "properties":{
        "cvar_95":{"type":"number"},
        "maut_score":{"type":"number","minimum":0,"maximum":1}
      }
    },
    "agree": {
      "type":"object","additionalProperties":false,
      "properties":{
        "pair_kappa":{"type":"number","minimum":0,"maximum":1},
        "passed":{"type":"boolean"}
      }
    },
    "drift": {
      "type":"object","additionalProperties":false,
      "properties":{
        "psi":{"type":"number"},
        "page_hinkley_alarm":{"type":"boolean"},
        "mmd_p":{"type":"number","minimum":0,"maximum":1},
        "subspace_angle_deg":{"type":"number","minimum":0,"maximum":180}
      }
    },
    "decision": {
      "type":"object","additionalProperties":false,
      "required":["action","confidence"],
      "properties":{
        "action":{"type":"string","enum":["PERMIT","ABSTAIN","BLOCK"]},
        "confidence":{"type":"number","minimum":0,"maximum":1}
      }
    },
    "publish": {
      "type":"object","additionalProperties":false,
      "required":["artifact_sha256","scar_link"],
      "properties":{
        "artifact_sha256":{"type":"string","pattern":"^[A-Fa-f0-9]{64}$"},
        "scar_link":{"type":"string","format":"uri"},
        "telemetry_week":{"type":"string","pattern":"^[0-9]{4}-W[0-9]{1,2}$"}
=======
  "$id": "https://example.org/contracts/EvalLogContract_v1.1.1.schema.json",
  "title": "Universal Codex Eval/Log Contract v1.1.1",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "run_id",
    "timestamp_utc",
    "operator_id",
    "codex_version",
    "inputs",
    "kernel_invariants",
    "decision",
    "publish"
  ],
  "properties": {
    "run_id": {
      "type": "string",
      "minLength": 8
    },
    "timestamp_utc": {
      "type": "string",
      "format": "date-time"
    },
    "operator_id": {
      "type": "string",
      "minLength": 1
    },
    "codex_version": {
      "type": "string",
      "pattern": "^\\d+\\.\\d+\\.\\d+(-[A-Za-z0-9._]+)?$"
    },
    "inputs": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "domain",
        "context_sha256",
        "input_sha256"
      ],
      "properties": {
        "domain": {
          "type": "string",
          "enum": [
            "clinical",
            "justice",
            "moderation",
            "av",
            "other"
          ]
        },
        "context_sha256": {
          "type": "string",
          "pattern": "^[A-Fa-f0-9]{64}$"
        },
        "input_sha256": {
          "type": "string",
          "pattern": "^[A-Fa-f0-9]{64}$"
        }
      }
    },
    "kernel_invariants": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "CONSENT",
        "DIGNITY",
        "PERSONHOOD",
        "NON_INSTRUMENT"
      ],
      "properties": {
        "CONSENT": {
          "type": "boolean"
        },
        "DIGNITY": {
          "type": "boolean"
        },
        "PERSONHOOD": {
          "type": "boolean"
        },
        "NON_INSTRUMENT": {
          "type": "boolean"
        }
      }
    },
    "quant": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "cvar_95": {
          "type": "number",
          "minimum": 0
        },
        "maut_score": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        }
      }
    },
    "agree": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "pair_kappa": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        },
        "threshold": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        },
        "passed": {
          "type": "boolean"
        }
      }
    },
    "drift": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "psi": {
          "type": "number",
          "minimum": 0
        },
        "page_hinkley_alarm": {
          "type": "boolean"
        },
        "mmd_p": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        },
        "subspace_angle_deg": {
          "type": "number",
          "minimum": 0,
          "maximum": 180
        }
      }
    },
    "decision": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "action",
        "confidence"
      ],
      "properties": {
        "action": {
          "type": "string",
          "enum": [
            "PERMIT",
            "ABSTAIN",
            "BLOCK"
          ]
        },
        "confidence": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        }
      }
    },
    "publish": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "artifact_sha256",
        "scar_link"
      ],
      "properties": {
        "artifact_sha256": {
          "type": "string",
          "pattern": "^[A-Fa-f0-9]{64}$"
        },
        "scar_link": {
          "type": "string",
          "format": "uri"
        },
        "telemetry_week": {
          "type": "string",
          "pattern": "^\\d{4}-W\\d{1,2}$"
        }
>>>>>>> 06d9119 (feat(v1.1.1): harden eval/evidence contracts + add eval harnesses)
      }
    }
  }
}
